
# 쿼토 PDF

PDF는 기술적, 학술적, 사업적으로 혁신적인 문서 양식이다. PDF가 개발된 것은 오랜 역사를 자랑하지만 아래한글, 워드퍼펙트, MS 워드, 리브레 워드 등에 가려 그 진가를  발휘하지 못했다. 하지만 이제 PDF는 문서 출판의 최고봉이라는데 이의를 제기하는  사람은 없을 것이다.

PDF 를 통해 아도비(Adobe) 회사는 엄청난 성공을 이어나가고 있고, 과학기술 
저작에도 필수적인 파일 형태라 PDF에 대한 기본소양은 인공지능 시대를 
살고 있는 시민으로 누구나 갖춰야하는 소양이다.


### $\LaTeX$ 엔진

보통 TexLive에 기반을 둔 `tinytex` 를 사용하는데 한글을 사용하는 입장에서는 `kotex`를 설치하는 방법도 모색이 필요하다.
유니코드 문자를 처리하기 위해서 `xelatex`이 Quarto $LaTeX$ 기본엔진이다. 달리 특정하지 않게 되면 `xelatex`을 통해 CJK 문자가 포함된 PDF 파일 제작이 가능하다.

````bash
quarto install tool tinytex
````

`kotex` 이 갖는 장점은 한글관련 이슈가 될만한 거의 모든 $LaTeX$ 패키지와 기본 한글글꼴도 내장하고 있다는 점이다. 하지만, `tidytex`를 기본 $LaTeX$ 엔진으로 사용하는 경우 빠진 패키지로 인해 후속 작업이 어려운 경우 `tinytex::parse_install()` 함수를 사용하게 되면 다음과 같이 오류난 텍스트를 붙여넣게 되면 자동으로 설치해준다. 

```{r}
#| eval = FALSE
tinytex::parse_install(
  text = "! LaTeX Error: File `titlepic.sty' not found."
)
```



### YAML 파일

문서를 구성하는 기본사항을 적어둔다. PDF 문서를 저작하는 것이라 $LaTeX$ 에 
대한 기본 지식은 Quarto PDF 문서를 생성하는데 많은 도움이 된다.
글꼴 지정관련하여 로컬 컴퓨터에 폰트 디렉토리에 관련 글꼴 정보가 운영체제와 
연결되어 있어야 한다.

Pandoc 문서에 메타데이터 [variables for LaTeX](https://pandoc.org/MANUAL.html#variables-for-latex)을 참조하여 필요한 상세설정작업을 수행한다.

````yaml
---
title: "한글 PDF"
format: 
  pdf:
    documentclass: report
    papersize: a4
    toc: true
    toc-depth: 2
    number-sections: true
    colorlinks: true
    include-in-header: 
      text: |
        \usepackage{pdfpages} 
bibliography: bibliography.bib
link-citations: yes
csl: apa-single-spaced.csl
mainfont: "NanumMyeongjo"
sansfont: "NanumGothic"
monofont: "D2Coding"
---
````

Quarto 가 문서 변환 핵심 엔진으로 사용하고 있는 Pandoc 은 $LaTeX$ 외에도 
ConTeXt, roff ms, HTML (via wkhtmltopdf) 을 사용해서 PDF 파일을 제작할 수 있다.
기존 Pandoc을 이런 방식으로 PDF 를 제작하신 분은 다음 내용을 건너뛰는 것도 좋을 듯 싶다.

### 저작

마크다운으로 이미지, 표, 텍스트, 서식, 수식 등 다양한 저작사항을 `.qmd` 파일에 담아내면 $LaTeX$ 엔진이 PDF로 변환작업을 수행해준다.

#### 이미지

$LaTeX$에 이미지도 삽입가능하다.

::: {layout-ncol=2}
![Allison Horst 박사가 그린 펭귄 3종 도식화](images/penguin_species.png){#fig-penguins}

![펭귄 부리(bill) 변수 설명](images/culmen_depth.png){#fig-bill}
:::

#### R 코드

$LaTeX$에 R 파이썬 코드를 통해 계산된 결과를 그래프, 표, 요약통계량 등으로 뽑아내 삽입가능하다.

```{r}
#| label: fig-entire
#| fig-cap: Penguin flipper length and body mass
#| eval: false
mass_flipper <- ggplot(data = penguins,
                       aes(x = flipper_length_mm,
                           y = body_mass_g)) +
  geom_point(size = 3,
             alpha = 0.8) +
  theme_minimal() +
  labs(title = "팔머 관측소 LTER 서식 펭귄 크기",
       subtitle = "Adelie, Chinstrap, Gentoo 펭귄에 대한 물갈퀴 길이와 체질량",
       x = "물갈퀴 길이(Flipper length) (mm)",
       y = "체질량(Body mass) (g)") +
  theme_minimal()

mass_flipper
```

#### 표

$LaTeX$에 $LaTeX$ 표를 넣을 수도 있고 R 혹은 파이썬에서 
나온 표를 PDF 파일에 넣을 수도 있다.

##### LaTeX 표 

\begin{tabular}{|l|l|}\hline
연령 & 빈도수 \\ \hline
18--25  & 15 \\
26--35  & 33 \\
36--45  & 22 \\ \hline
\end{tabular}

##### `gt` 표


```{r}
knitr::kable(
  mtcars[1:6, 1:10]
)
```

#### 데이터

:::{.callout-caution collapse="true"}
### 데이터 수집에 대해 궁금하신 분은 클릭하여 추가 학습하세요
팔머펭귄 데이터는 Kristen Gorman 박사와 남국 팔머 관측소(Palmer Station, Antarctica LTER)에서 수집되어 공공에 이용가능하게 공개되었습니다.
:::

{palmerpenguins} 패키지 [@palmer-penguins]를 통해 R에서 손쉽게 이용가능하게 
되었고 원데이터는 @Gorman-2014 에서 최초 공개되었다.


#### PDF 겉면

`fitpaper` $LaTeX$ 패키지를 사용해서 책 첫장(`\frontmatter`)과 마지막장(`\backmatter`) 겉면을 장식할 수 있다.

````pdf
\includepdf[fitpaper]{book/canva-backmatter}
````

## 한글 글꼴

Quarto [PDF Engines](https://quarto.org/docs/output-formats/pdf-engine.html)에서 $LaTeX$ 엔진을 별도 다룰 정도로 $LaTeX$ 엔진은 중요하다.
Quarto 에서는 [TinyTeX](https://yihui.org/tinytex/)를 기반엔진으로 사용되는데 [TeX Live](https://tug.org/texlive/) 배포판에 기반하고 Pandoc 에서 가장 많이 사용되는 대략 200 여개 패키지를 포함시켜 사용성은 좋게하면서 크기는 대폭 줄였다.

`.qmd` 파일 YAML 헤더에 로컬 컴퓨터에 등록된 글꼴을 지정하는 방식도 있다.

````yaml
mainfont: "NanumMyeongjo"
sansfont: "NanumGothic"
monofont: "D2Coding"
CJKmainfont: "NanumGothic"
````

다른 방식은 글꼴 관련 사항은 `packages.tex` $TeX$ 파일에 지정하는 것이다.

````yaml
format:
  pdf:
    include-in-header:
      - packages.tex
      - macros.tex
    include-before-body: before.tex
````

예를 들어 `packages.tex` 에 한글 글꼴을 다음과 같이 지정한다.

````latex
% 한글 폰트 ----------------------------
\setmainhangulfont{NanumMyeongjo} % 나눔명조
\setsanshangulfont{NanumGothic}   % 나눔고딕
\setmonohangulfont{D2Coding}      % D2코딩
````

:::{.callout-note collapse="false"} 
 
[이광춘, "글을 쓰는 것은 소프트웨어 개발이다!", 강서양천신문 특집기고(’15년 9월)](https://aispiration.com/ds-authoring/ct-writing.html) 와 [LaTeX, PDF, 문서, 그리고 사고](http://aispiration.com/latex/)에서 관련 내용을 발췌한 것임을 밝혀둡니다. 그리고, [Quarto PDF](https://quarto.org/docs/output-formats/pdf-basics.html) 문서를 많이 참고 했습니다.
::: 
