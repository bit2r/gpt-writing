---
output: html_document
editor_options: 
  chunk_output_type: console
editor: 
  markdown: 
    wrap: sentence
---

![](images/horst_quarto_schematic.png)

# 쿼토(Quarto)

쿼토(Quarto)는 다양한 프로그래밍 언어와 통합된 오픈소스 출판시스템이다.
[Pandoc](https://pandoc.org/)에 기반을 두고 있으며, 프로그래밍 언어로 R, 파이썬, 줄리아, 자바스크립트(Observable JS) 등을 지원한다.
사용자는 다양한 출판 저작물을 생성할 수 있고, "차세대 R마크다운(Next-Generation R Markdown)"이라는 별명을 가지고 있는데 약 10년에 걸친 R 마크다운 성공과 실패 경험을 바탕으로 전혀 새로운 아키텍처로 재탄생했다.
쿼토의 개발 및 유지보수 팀이 잘 구성되어 있어 프로젝트의 지속 가능성과 신뢰성이 높다.
무료로 제공되기 때문에 누구나 쉽게 접근하고 기여할 수 있다.
[@hyde2021single]

디지털 글쓰기 출판시스템에 대한 고민은 크게 세 가지로 나뉜다.

-   **콘텐츠(Content)**: 저작물과 관련된 실질적인 내용
-   **디자인(Design)**: 출판물 외양, 즉 'Look and Feel'
-   **형식(Format)**: 출판물 최종 형태나 산출물

쿼토는 세 가지 요소를 충족시키기 위해 다양한 기능을 제공한다.
팬독(Pandoc)과 마크다운을 활용하여 수식, 인용, 서지관리, 콜아웃(callout), 고급 레이아웃 등을 문서 저작을 지원하고, 고품질 논문, 보고서, 발표슬라이드(PPT), 웹사이트, 블로그, 전자책 등 다양한 형태 출판 산출물을 HTML, PDF, MS 워드, ePub 등 다양한 디지털 형식로 제작할 수 있다.
특히, 프로그래밍 언어와 문서 저작, 출판 산출물 사이의 연결고리로서 쿼토는 매우 유용한 도구로 평가받고 있으며, 버전 제어와 협업, 재현가능 과학기술 문서와 비즈니스에서 요구되는 자동화된 생산성 높은 문서저작에 큰 장점이 있다.

+---------------------------------+-----------------------------+------------------------------------+
| 프로그래밍(계산)                | 문서 저작                   | 출력물                             |
+:===============================:+:===========================:+:==================================:+
| Python, R, Julia, Observable JS | Pandoc, 마크다운 (Markdown) | 문서, 웹사이트, PPT, 책, 블로그 등 |
+---------------------------------+-----------------------------+------------------------------------+

## Single Sourcing 출판저작

데이터 사이언스 출판저작에 다소 차이는 있지만 출판에 대한 대체적인 방식은 유사할 것으로 보인다.
즉, Single Sourcing 을 콘텐츠 저작, 디자인, 최종 출판물 관리까지 일원화되어 자동화되어 체계적으로 관리된다면 중복되는 낭비는 물론 재현가능성도 높여 과학기술 출판저작물로 가장 이상적으로 간주되고 있다.

### 문제점

![문제점](images/single-sourcing-problem.jpg){#fig-problem}

### 개념

![Single Sourcing 개념](images/single-sourcing-concept.jpg){#fig-concept}

### Single Sourcing Multi-Use

![Single Sourcing Multi-Use](images/single-sourcing-publishing.jpg){#fig-publishing}

## 작업흐름

기존 R `.Rmd`, 파이썬 `.ipynb` 확장자를 갖는 작업흐름이 `.qmd` 파일로 단일화되는 것이 가장 큰 특징이다.
따라서 마크다운으로 콘텐츠를 작성하고 프로그래밍 코드를 R, 파이썬, 자바스크립트, 쥴리아 로 작성하게 되면 자동으로 계산을 수행하고 결과물을 마크다운으로 변환시키기 때문에 후속 작업을 신경쓰지 않고 원하는 결과물을 얻을 수 있는 장점이 있다.

### R (`.Rmd`)

![](images/rmd-knitr.png)

### 파이썬 (주피터)

![](images/jupyter-alone.png)

### Quarto - R

![](images/qmd-knitr.png)

### Quarto - 파이썬

![](images/qmd-jupyter.png)


## 쿼토 해부

쿼토는 데이터 과학 문서 작성 패러다임을 바꾼 R마크다운의 후속작으로 볼 수 있다.
쿼토는 10년 이상의 `knitr` 경험을 바탕으로 개발되었으며, 최근에는 위지윅(What You See Is What You Get) 패러다임도 RStudio **Visual 편집**에 도입하여 복잡한 코드 작성 없이 직관적으로 문서를 작성할 수 있다.
R 사용자는 RStudio IDE, 파이썬 등 개발 경험이 풍부하신 분들은 파이참, VS코드, 이맥스/VIM 등 통합개발환경(IDE)을 쿼토 CLI를 통해 출판물을 쉽게 저작할 수 있다.

쿼토는 다양한 프로그래밍 언어를 통해 계산(Computation) 기능을 문서에 담을 수 있도록 지원한다.
R, 파이썬, SQL, 자바스크립트 등 다양한 프로그래밍 언어로 문서 내에 그래프, 표, 인터랙티브 결과물을 쉽게 삽입할 수 있다.
이러한 장점들이 모여 문서를 제작하고 유통하고 소비하는 데이터 과학자, 개발자, 과학기술 연구원, 사무노동자 분들의 시간을 줄여주고 업무 생산성을 크게 높여주는 도구로 자리매김하고 있다.

![쿼토 작업흐름](images/quarto-unification.png)

쿼토 저작은 메타데이터(전문, front matter), 텍스트, 코드라는 세 가지 주요 구성요소로 이뤄진다.

-   메타데이터 (YAML): YAML은 "YAML Ain't Markup Language"의 약자로, 데이터를 구조화하기 위한 언어로, 쿼토에서 문서에서 전문(Front Matter)을 구성하는 문서 제목, 작성자, 날짜, 문서 형식 등을 정의한다. 메타데이터는 보통 문서 상단에 위치하며, 문서의 전반적인 설정과 구성을 담당한다.
-   텍스트 (마크다운): 마크다운도 언어로, 2004년 아론 스워츠와 존 그루버가 주도하여 탄생했다. HTML 같은 복잡한 마크업 언어 대신, 간단한 형식의 문서를 빠르고 효율적으로 작성할 수 있는 도구로 복잡한 디자인보다는 내용의 구조와 의미에 중점을 두기 때문에 문서 작성자는 외양보다 내용에 더 집중할 수 있다는 장점이 있다.
-   코드 (`knitr`, `jupyter`): `knitr`는 R 코드를 문서에 통합을 가능케하고, `jupyter`는 파이썬 사용자에게 인기있는 패키지다. 쿼토에서 `knitr`, `jupyter`에서 작성된 코드를 문서에 포함시킬 수 있어 데이터 분석 통계값, 그래프, 다이어그램, 지도 등 다양한 결과물을 문서에 삽입할 수 있다.

![Quarto 문서 구성요소](images/quarto-anatomy.png){fig-align="center" width="450"}

### YAML

YAML(발음은 야믈)은 쿼토파일 메타데이터로 문서 본문보다 먼저 제시되는 전문(front matter)으로 문서를 구조화하기 R 마크다운, 쿼토에서 도입된 경량언어로 쿼토에서는 문서 제목, 작성자, 날짜, 문서 형식, 레이아웃 등을 정의한다.
보통 키값(key-value) 쌍을 이루는데, 키는 콜론(:)으로 값과 구분한다.

::: columns
::: {.column width="45%"}
### 키값 쌍 {.unnumbered}

``` yaml
---
key: value
---
```
:::

::: {.column width="5%"}
:::

::: column
### 문서출력형식 PDF 지정 {.unnumbered}

``` yaml
---
format: pdf
---
```
:::
:::


YAML로 문서 전문을 작성하게 되면 가독성이 뛰어나 읽고 이해하기 쉽다.
복잡한 문서 구조나 설정을 지정할 때 특히 유용하다.
중첩된 선택옵션과 같은 복잡한 문서구조도 들여쓰기(indent)를 통해 명확히 표현된다.
재사용성도 뛰어나 같은 설정 값을 여러 곳에서 사용해야 할 경우, YAML 파일 하나를 수정하면 모든 곳에 적용될 수 있어 시간과 노력을 절약해준다.
또한, 텍스트 기반이라 Git과 같은 버전 제어 시스템과 잘 통합되어 여러 저자가 공동 작업 진가를 발휘한다.
하지만, 들여쓰기에 민감하여 실수로 공백을 잘못 넣었을 경우 오류가 발생할 수 있으므로 주의가 요구된다.

YAML은 단순히 `KEY: Value` 에 불과한데 사례를 통해 YAML의 편리성과 유용함을 살펴보자.

::: columns
::: {.column width="45%"}
### CLI PDF 지정 {.unnumbered}

``` bash
$ quarto render document.qmd --to pdf
```
:::

::: {.column width="5%"}
:::

::: column
### YAML 문서형식 PDF {.unnumbered}

``` yaml
---
format: pdf
---
```
:::
:::

다음 예시에서 `quarto render` 명령을 사용하여 `document.qmd` 파일을 `HTML` 형식 문서로 제작하는데 CLI에서 옵션에서 `-M code fold:true`을 통해 코드 섹션을 접을 수 있는 형태로 제작함을 나타내고 있다.

동일한 의도를 `YAML` 설정으로 바꾸면, 설정 파일에 `format` 섹션을 만들고 그 안에 `html`을 정의하고 나서, `html` 포맷에 목차 생성(`toc: true`)과 코드 접기 기능(`code-fold: true`)을 추가로 설정했다.

동일한 의도를 CLI에 넣는 것보다 YAML 파일에 담게되면 훨씬 깔끔하고 우아하다.
많은 선택옵션들이 명령어로 직접 들어가면 명령어가 길어져 가독성이 떨어지고, 나중에 어떤 옵션을 사용했는지 파악하기도 어렵다.
반면 `YAML` 파일이 도입되면, 설정을 한 곳에서 명확하게 관리할 수 있어 유지보수도 편리하고, 공동 저작자들과 쉽게 공유되기 때문에 협업에도 유리하다.

::: columns
::: {.column width="45%"}
### CLI 코드접기 {.unnumbered}

``` bash
$ quarto render document.qmd --to html -M code fold:true
```
:::

::: {.column width="5%"}
:::

::: column
### YAML 코드접기 {.unnumbered}

``` yaml
---
format: 
  html:
    toc: true
    code-fold: true
---
```
:::
:::

문서저작 통합개발환경(IDE) RStudio나 VSCode 에서 제공하는 탭-자동완성(Tab Completion) 기능은 YAML 전문코드를 작성할 때 큰 도움이 된다.
첫 글자나 몇몇 글자를 타이핑한 후에 탭 키를 누르면, IDE가 가능한 모든 명령어나 변수, 함수 이름 등을 보여주기 때문에 저작자는 오타를 줄이고 빠르게 문서를 저작할 수 있다.
RStudio에서 <kbd>`Ctrl + space`</kbd> 단축키를 사용하면, YAML 전문코드를 작성할 때 키값을 선택할 수 있는 목록을 보여준다.

::: {#fig-yaml layout="[45,-5,45]"}
![YAML 키 설정](images/yaml_before.png){fig-align="center"}

![탭 자동완성 선택확정](images/yaml_after.png){fig-align="center"}

RStudio YAML 자동완성
:::


### 마크다운


### 프로그래밍 언어


## 주요 기능

+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Feature          | R Markdown                                                                                               | Quarto                                                                             |
+==================+==========================================================================================================+====================================================================================+
| Basic Formats    | -   [html_document](https://pkgs.rstudio.com/rmarkdown/reference/html_document.html)                     | -   [html](https://quarto.org/docs/output-formats/html-basics.html)                |
|                  |                                                                                                          |                                                                                    |
|                  | -   [pdf_document](https://pkgs.rstudio.com/rmarkdown/reference/pdf_document.html)                       | -   [pdf](https://quarto.org/docs/output-formats/pdf-basics.html)                  |
|                  |                                                                                                          |                                                                                    |
|                  | -   [word_document](https://pkgs.rstudio.com/rmarkdown/reference/word_document.html)                     | -   [docx](https://quarto.org/docs/output-formats/ms-word.html)                    |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Beamer           | -   [beamer_presentation](https://pkgs.rstudio.com/rmarkdown/reference/beamer_presentation.html)         | -   [beamer](https://quarto.org/docs/presentations/beamer.html)                    |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| PowerPoint       | -   [powerpoint_presentation](https://pkgs.rstudio.com/rmarkdown/reference/powerpoint_presentation.html) | -   [pptx](https://quarto.org/docs/presentations/powerpoint.html)                  |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| HTML Slides      | -   [xaringan](https://bookdown.org/yihui/rmarkdown/xaringan.html)                                       | -   [revealjs](https://quarto.org/docs/presentations/revealjs/)                    |
|                  |                                                                                                          |                                                                                    |
|                  | -   [revealjs](https://bookdown.org/yihui/rmarkdown/revealjs.html)                                       |                                                                                    |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Advanced Layout  | -   [tufte](https://bookdown.org/yihui/rmarkdown/tufte-handouts.html)                                    | -   [Quarto Article Layout](https://quarto.org/docs/authoring/article-layout.html) |
|                  |                                                                                                          |                                                                                    |
|                  | -   [distill](https://rstudio.github.io/distill/figures.html)                                            |                                                                                    |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Cross References | -   [html_document2](https://bookdown.org/yihui/bookdown/a-single-document.html)                         | -   [Quarto Crossrefs](https://quarto.org/docs/authoring/cross-references.html)    |
|                  | -   [pdf_document2](https://bookdown.org/yihui/bookdown/a-single-document.html)                          |                                                                                    |
|                  | -   [word_document2](https://bookdown.org/yihui/bookdown/a-single-document.html)                         |                                                                                    |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Websites & Blogs | -   [blogdown](https://pkgs.rstudio.com/blogdown/)                                                       | [Quarto Websites](https://quarto.org/docs/websites/)                               |
|                  |                                                                                                          |                                                                                    |
|                  | -   [distill](https://pkgs.rstudio.com/distill/)                                                         | [Quarto Blogs](https://quarto.org/docs/websites/website-blog.html)                 |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Books            | -   [bookdown](https://pkgs.rstudio.com/bookdown/)                                                       | [Quarto Books](https://quarto.org/docs/books/)                                     |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Interactivity    | [Shiny Documents](https://bookdown.org/yihui/rmarkdown/shiny-documents.html)                             | [Quarto Interactive Documents](https://quarto.org/docs/interactive/shiny/)         |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Paged HTML       | [pagedown](https://github.com/rstudio/pagedown)                                                          | Summer 2022                                                                        |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Journal Articles | [rticles](https://pkgs.rstudio.com/rticles/)                                                             | Summer 2022                                                                        |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+
| Dashboards       | [flexdashboard](https://pkgs.rstudio.com/flexdashboard/) \|                                              | Fall 2022                                                                          |
+------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+

