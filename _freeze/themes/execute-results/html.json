{
  "hash": "4c7ebb1b742603e5748bef2e9a4c2658",
  "result": {
    "markdown": "\n# 테마\n\n## 그래픽 테마\n\n`ggplot2`에 기본으로 제공되는 `theme`이 9개가 있어, \n각 테마별로 시각화해보고 추후 가장 적합한 그래프를 선정한다.\n먼저, 각 테마를 달리 적용하여 비교할 수 있는 기본 `ggplot` 그래프를 준비한다.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(palmerpenguins)\n\nbase_penguins_gg <- penguins |> \n  ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n    geom_point(aes(color = species, shape = species), size = 3) +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"black\")  +\n    labs(\n      title = \"기본 테마\",\n      subtitle = \"물갈퀴 길이와 체중 회귀분석\",\n      x = \"물갈퀴 길이 (mm)\",\n      y = \"체중 (g)\",\n      color = \"펭귄종\",\n    ) +\n    guides(shape = \"none\") +\n    theme(legend.position = c(0.90, 0.15))\n\nbase_penguins_gg\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n펭귄 데이터셋을 사용하여 물갈퀴 길이와 체중 사이의 관계를 시각화하는 그래프를 \n`draw_themes()` 함수로 테마를 달리 적용하여 `ggplot` 그래프를 생성한 후에\n리스트 객체로 저장한다.\n\n다양한 테마를 `draw_themes()` 함수에 인자로 넘기기 위해 `themes_name`과 `themes_vector`에 테마명과 테마 함수를 저장장 한 후  `map2()` 함수로 테마를 달리한 `ggplot` 그래프를 저장한다. 마지막으로, `patchwork::wrap_plots()` 함수를 사용하여 모든 그래프를 결합하여 하나의 그래프로 출력한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndraw_themes <- function(theme_name, theme_choice) {\n  penguins |> \n    ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n      geom_point(aes(color = species, shape = species), size = 1) +\n      geom_smooth(method = \"lm\", se = FALSE, color = \"black\")  +\n      labs(\n        title = theme_name,\n        subtitle = \"물갈퀴 길이와 체중 회귀분석\",\n        x = \"물갈퀴 길이 (mm)\",\n        y = \"체중 (g)\",\n        color = \"펭귄종\",\n      ) +\n      guides(shape = \"none\") +\n      theme_choice() +\n      theme(legend.position = c(0.90, 0.15))    \n}\n\n## 테마명과 벡터\nthemes_name <- c(\"theme_gray\", \"theme_bw\", \"theme_linedraw\", \n                 \"theme_light\", \"theme_dark\", \"theme_minimal\", \"theme_classic\", \n                 \"theme_void\", \"theme_test\")\n\nthemes_vector <- c(theme_gray , theme_bw , theme_linedraw , \n                  theme_light , theme_dark , theme_minimal , theme_classic , \n                  theme_void , theme_test )\n\ntheme_output <- map2(themes_name, themes_vector, draw_themes)\n\npatchwork::wrap_plots(theme_output)\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n### `hrbrthemes`\n\n밥 루디스가 제작한 `hrbrthemes` 테마 패키지는 특히 텍스트가 많은 비즈니스 유형의 프레젠테이션에 적합한 테마와 테마 구성 요소를 제공한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(hrbrthemes)\n\nhrbr_themes_name <- c(\"theme_ipsum\", \"theme_ipsum_ps\", \"theme_ipsum_es\", \"theme_ipsum_rc\", \"theme_ipsum_ps\", \"theme_ipsum_pub\", \"theme_ipsum_tw\", \"theme_modern_rc\", \"theme_ft_rc\")\n\nhrbr_themes_vector <- c(theme_ipsum, theme_ipsum_ps, theme_ipsum_es, theme_ipsum_rc, theme_ipsum_ps, theme_ipsum_pub, theme_ipsum_tw, theme_modern_rc, theme_ft_rc)\n\nhrbr_theme_output <- map2(hrbr_themes_name, hrbr_themes_vector, draw_themes)\n\npatchwork::wrap_plots(hrbr_theme_output)\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n### `ggthemes`\n\n제프리 아놀드(Jeffrey Arnold)가 제작한 `ggthemes` 테마 패키지는 소프트웨어, 데이터 시각화 선구자 및 다양한 곳에서 영감을 얻은 다양한 테마를 제공한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggthemes)\n\nggthemes_name <- c(\"theme_base()\",\"theme_calc()\",\"theme_clean()\",\"theme_economist()\", \"theme_economist_white()\",\"theme_excel()\",\"theme_excel_new()\",\"theme_few()\",\"theme_fivethirtyeight()\",\"theme_foundation()\",\"theme_gdocs()\",\"theme_hc()\",\"theme_igray()\",\"theme_map()\",\"theme_pander()\",\"theme_solarized_2()\",\"theme_solid()\",\"theme_stata()\",\"theme_tufte()\",\"theme_wsj()\")\n\nggthemes_vector <- c(theme_base, theme_calc, theme_clean, theme_economist, theme_economist_white, theme_excel, theme_excel_new, theme_few, theme_fivethirtyeight, theme_foundation, theme_gdocs, theme_hc, theme_igray, theme_map, theme_pander, theme_solarized_2, theme_solid, theme_stata, theme_tufte, theme_wsj)\n\nggtheme_output <- map2(ggthemes_name, ggthemes_vector, draw_themes)\n\npatchwork::wrap_plots(ggtheme_output)\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n### `wesanderson`\n\n웨스 앤더슨(Wes Anderson) 영화의 독특하고 눈에 띄는 스타일을 기반으로 한 색상 팔레트를 제공하는 패키지다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(wesanderson)\n\ndraw_wesanderson <- function(palette_name, wesanderson_palette =\"Darjeeling1\") {\n  penguins |> \n    ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n      geom_point(aes(color = species, shape = species), size = 1) +\n      geom_smooth(method = \"lm\", se = FALSE, color = \"black\")  +\n      labs(\n        title = palette_name,\n        subtitle = \"물갈퀴 길이와 체중 회귀분석\",\n        x = \"물갈퀴 길이 (mm)\",\n        y = \"체중 (g)\",\n        color = \"펭귄종\",\n      ) +\n      guides(shape = \"none\") +\n      theme_minimal() +\n      theme(legend.position = c(0.90, 0.15)) +  \n      scale_color_manual(values= wes_palette(wesanderson_palette, n = 3))\n}\n\nwes_theme_output <- map2(names(wes_palettes), names(wes_palettes), draw_wesanderson)\n\npatchwork::wrap_plots(wes_theme_output)\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## 사용자 테마\n\n설치한 한글 글꼴과 색상을 매칭하여 사용자 맞춤 테마(`theme_penguin`)을 생성하고\n색상은 `wesanderson` 패키지에서 `Darjeeling1` 5가지 색상을 사용하여 시각화한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nextrafont::loadfonts(\"win\")\n\ntheme_penguin <- function() {\n  \n  # ggthemes::theme_tufte() +\n  theme_minimal() +\n    \n  theme(\n      plot.title     = element_text(family = \"NanumSquare\", size = 18, face = \"bold\"),\n      plot.subtitle  = element_text(family = \"MaruBuri\", size = 13),\n      axis.title.x   = element_text(family = \"MaruBuri\"),\n      axis.title.y   = element_text(family = \"MaruBuri\"),\n      axis.text.x    = element_text(family = \"MaruBuri\", size = 11),\n      axis.text.y    = element_text(family = \"MaruBuri\", size = 11),\n      legend.title   = element_text(family = \"MaruBuri\", size=13),\n      plot.caption   = element_text(family = \"NanumSquare\", color = \"gray20\")\n  )\n}\n\ndarjeeling1_palette <- wes_palette(\"Darjeeling1\", n = 5)\n\npenguins |> \n  ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n    geom_point(aes(color = species, shape = species), size = 3) +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"black\")  +\n    labs(\n      title = \"물갈퀴 길이와 체중 회귀분석\",\n      subtitle = \"남극 파머 펭귄 데이터셋\",\n      x = \"물갈퀴 길이 (mm)\",\n      y = \"체중 (g)\",\n      color = \"펭귄종\",\n      caption = \"자료출처: palmerpenguins 패키지\"\n    ) +\n  guides(shape = \"none\") +\n  scale_color_manual(values =  darjeeling1_palette) +\n  theme_penguin()\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## 그래프 자동 설정\n\n작성한 테마를 매번 코드를 \"복사하여 붙여넣기\" 하여 사용하는 대신 `.Rprofile` 파일에 반영하여\n매번 `ggplot` 시각화를 할 때 사용하는 방법을 살펴보자. `usethis` 패키지 `edit_r_profile()` 함수를\n호출하여 앞서 작성한 테마를 반영한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::edit_r_profile()\n```\n:::\n\n\n`theme_penguin()` 테마를 `ggplot2` 패키지 `theme_set()`으로 설정하고 기본 색상을 정의하면 시각화 그래프에 반영하여 사용할 수 있다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressWarnings(suppressMessages({\n\n  extrafont::loadfonts(\"win\")\n\n\n  ## 테마 (글꼴) -----------------------------\n  theme_penguin <- function() {\n\n    # ggthemes::theme_tufte() +\n    ggplot2::theme_minimal() +\n\n      ggplot2::theme(\n        plot.title     = ggplot2::element_text(family = \"NanumSquare\", size = 18, face = \"bold\"),\n        plot.subtitle  = ggplot2::element_text(family = \"MaruBuri\", size = 13),\n        axis.title.x   = ggplot2::element_text(family = \"MaruBuri\"),\n        axis.title.y   = ggplot2::element_text(family = \"MaruBuri\"),\n        axis.text.x    = ggplot2::element_text(family = \"MaruBuri\", size = 11),\n        axis.text.y    = ggplot2::element_text(family = \"MaruBuri\", size = 11),\n        legend.title   = ggplot2::element_text(family = \"MaruBuri\", size=13),\n        plot.caption   = ggplot2::element_text(family = \"NanumSquare\", color = \"gray20\")\n      )\n  }\n\n  ## 색상\n  ### 웨스 앤더슨\n  color_palette <- wesanderson::wes_palette(\"Darjeeling1\", n = 5)\n\n  ggplot2::theme_set(theme_penguin())\n\n}))\n```\n:::\n\n\n`.Rprofile` 파일에 `ggplot()` 사용자 정의 테마가 지정되어 있기 때문에 새로 R 세션을 시작하면 \n`theme_penguin()` 테마 및 웨스 앤더스 `color_palette` 색상 팔레트도 사용할 수 있다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(palmerpenguins)\n\npenguins_theme_gg <- penguins |> \n  ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n    geom_point(aes(color = species, shape = species), size = 3) +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"black\")  +\n    labs(\n      title = \"물갈퀴 길이와 체중 회귀분석\",\n      subtitle = \"남극 파머 펭귄 데이터셋\",\n      x = \"물갈퀴 길이 (mm)\",\n      y = \"체중 (g)\",\n      color = \"펭귄종\",\n      caption = \"자료출처: palmerpenguins 패키지\"\n    ) +\n  guides(shape = \"none\") +\n  scale_color_manual(values =  color_palette) +\n  theme_penguin()\n\nragg::agg_jpeg(\"images/penguins_theme_gg.jpg\",\n              width = 10, height = 7, units = \"in\", res = 600)\npenguins_theme_gg\ndev.off()\n```\n:::\n\n\n![펭귄 데이터 사용자 테마 적용 그래프](images/penguins_theme_gg.jpg)\n\n## 표 테마\n\n`ggplot` 뿐만 아니라 `gt` 패키지에도 사용자 정의 테마 설정 기능이 있다.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(palmerpenguins)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(magick)\n\npenguins_gt <- penguins |> \n  count(species, island) |> \n  pivot_wider(names_from = island, values_from = n, values_fill = 0) |> \n  as_tibble() |> \n  gt(rowname_col = \"species\") |> \n    tab_header(\n      title = md(\"남극 펭귄 **서식섬과 종** 빈도표\"),\n      subtitle = md(\"`palmerpenguins` 데이터 패키지\")\n    ) |> \n    grand_summary_rows(\n      columns = c(Biscoe, Dream, Torgersen),\n      fns = list(\n        '합계' = ~sum(.) \n      ),\n      fmt = ~ fmt_number(., use_seps = FALSE, decimals = 0),\n      missing_text = '-'\n    )  |> \n    cols_align(\"center\") |> \n    opt_row_striping() |> \n    tab_source_note(\n      source_note = md(\"자료출처: `penguins` 데이터셋\")\n  )\n\npenguins_gt\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gapdrndnln\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gapdrndnln table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gapdrndnln thead, #gapdrndnln tbody, #gapdrndnln tfoot, #gapdrndnln tr, #gapdrndnln td, #gapdrndnln th {\n  border-style: none;\n}\n\n#gapdrndnln p {\n  margin: 0;\n  padding: 0;\n}\n\n#gapdrndnln .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gapdrndnln .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gapdrndnln .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gapdrndnln .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gapdrndnln .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gapdrndnln .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gapdrndnln .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gapdrndnln .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gapdrndnln .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gapdrndnln .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gapdrndnln .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gapdrndnln .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gapdrndnln .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gapdrndnln .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gapdrndnln .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gapdrndnln .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gapdrndnln .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gapdrndnln .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gapdrndnln .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gapdrndnln .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gapdrndnln .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gapdrndnln .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gapdrndnln .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gapdrndnln .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gapdrndnln .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gapdrndnln .gt_left {\n  text-align: left;\n}\n\n#gapdrndnln .gt_center {\n  text-align: center;\n}\n\n#gapdrndnln .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gapdrndnln .gt_font_normal {\n  font-weight: normal;\n}\n\n#gapdrndnln .gt_font_bold {\n  font-weight: bold;\n}\n\n#gapdrndnln .gt_font_italic {\n  font-style: italic;\n}\n\n#gapdrndnln .gt_super {\n  font-size: 65%;\n}\n\n#gapdrndnln .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gapdrndnln .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gapdrndnln .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gapdrndnln .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gapdrndnln .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gapdrndnln .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gapdrndnln .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal\" style>남극 펭귄 <strong>서식섬과 종</strong> 빈도표</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style><code>palmerpenguins</code> 데이터 패키지</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Biscoe\">Biscoe</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Dream\">Dream</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Torgersen\">Torgersen</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Adelie</th>\n<td headers=\"stub_1_1 Biscoe\" class=\"gt_row gt_center\">44</td>\n<td headers=\"stub_1_1 Dream\" class=\"gt_row gt_center\">56</td>\n<td headers=\"stub_1_1 Torgersen\" class=\"gt_row gt_center\">52</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Chinstrap</th>\n<td headers=\"stub_1_2 Biscoe\" class=\"gt_row gt_center gt_striped\">0</td>\n<td headers=\"stub_1_2 Dream\" class=\"gt_row gt_center gt_striped\">68</td>\n<td headers=\"stub_1_2 Torgersen\" class=\"gt_row gt_center gt_striped\">0</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Gentoo</th>\n<td headers=\"stub_1_3 Biscoe\" class=\"gt_row gt_center\">124</td>\n<td headers=\"stub_1_3 Dream\" class=\"gt_row gt_center\">0</td>\n<td headers=\"stub_1_3 Torgersen\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><th id=\"grand_summary_stub_1\" scope=\"row\" class=\"gt_row gt_left gt_stub gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">합계</th>\n<td headers=\"grand_summary_stub_1 Biscoe\" class=\"gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">168</td>\n<td headers=\"grand_summary_stub_1 Dream\" class=\"gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">124</td>\n<td headers=\"grand_summary_stub_1 Torgersen\" class=\"gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">52</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\">자료출처: <code>penguins</code> 데이터셋</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n### 기본 색상과 스타일\n\n\n::: {.cell}\n\n```{.r .cell-code}\nopt_colors <- c(\"blue\", \"cyan\", \"pink\", \"green\", \"red\", \"gray\")\n\ndraw_color_gt <- function(gt_color = \"blue\") {\n  penguins_gt |> \n    opt_stylize(style = 1, color = gt_color)\n}                \n\ngt_colors_list <- map(opt_colors, draw_color_gt)\n\n\nfor(i in 1:length(opt_styles)) {\n  gtsave(gt_colors_list[[i]], str_glue(\"images/gt_theme_{opt_colors[i]}.png\"))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(magick)\n\nopt_colors <- c(\"blue\", \"cyan\", \"pink\", \"green\", \"red\", \"gray\")\n\ncolor_path_filenames <- vector(mode = \"character\", length = length(opt_colors))\n\nfor(i in 1:length(opt_colors)) {\n  color_path_filenames[i] <-  str_glue(\"images/gt_theme_{opt_colors[i]}.png\")\n}\n\ngt_color_images_list <- map(color_path_filenames, magick::image_read) |> \n  map(image_resize, geometry = \"200x200\")\n\ngt_color_images <- image_join(gt_color_images_list)\n\nimage_append(gt_color_images, stack = FALSE)\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-12-1.png){width=600}\n:::\n:::\n\n\n### 스타일\n\n\n::: {.cell}\n\n```{.r .cell-code}\nopt_sytles <- 1:6\n\ndraw_style_gt <- function(opt_sytle, gt_color = \"blue\") {\n  penguins_gt |> \n    opt_stylize(style = opt_sytle, color = gt_color)\n}                \n\ngt_styles_list <- map(opt_sytles, draw_style_gt)\n\n\nfor(i in 1:length(opt_styles)) {\n  gtsave(gt_styles_list[[i]], str_glue(\"images/gt_theme_style_{opt_sytles[i]}.png\"))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nopt_sytles <- 1:6\n\nstyle_path_filenames <- vector(mode = \"character\", length = length(opt_sytles))\n\nfor(i in 1:length(opt_sytles)) {\n  style_path_filenames[i] <-  str_glue(\"images/gt_theme_style_{opt_sytles[i]}.png\")\n}\n\ngt_style_images_list <- map(style_path_filenames, magick::image_read) |> \n  map(image_resize, geometry = \"200x200\") \n  \ngt_style_images <- image_join(gt_style_images_list)\n\nimage_append(gt_style_images, stack = FALSE)\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-14-1.png){width=600}\n:::\n:::\n\n\n\n### `gtExtra`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngtExtra_themes <- c(gt_theme_538, gt_theme_espn, gt_theme_nytimes, gt_theme_guardian,\n                    gt_theme_dot_matrix, gt_theme_dark, gt_theme_excel, gt_theme_pff)\n\ngtExtra_themes_names <- c(\"gt_theme_538\", \"gt_theme_espn\", \"gt_theme_nytimes\",\n                          \"gt_theme_guardian\", \"gt_theme_dot_matrix\", \"gt_theme_dark\",\n                          \"gt_theme_excel\", \"gt_theme_pff\")\n\ndraw_gtExtras_theme <- function(gt_theme) {\n  penguins_gt |> \n    gt_theme()\n}\n\n# draw_gtExtras_theme(gtExtra_themes[5][[1]])\n## gtExtras 테마적용 표 -------------------\n\ngtExtra_styles_list <- vector(mode =\"list\", length = length(gtExtra_themes))\n\nfor(i in 1:length(gtExtra_themes)) {\n  gtExtra_styles_list[[i]] <-  draw_gtExtras_theme(gtExtra_themes[i][[1]])\n}\n\n## 테마 표 png 파일 저장 -------------------\n\ngtExtras_path_filenames <- vector(mode = \"character\", length = length(gtExtra_themes))\n\nfor(i in 1:length(gtExtra_themes)) {\n  gtExtras_path_filenames[i] <-  str_glue(\"images/gtExtras_theme_{gtExtra_themes_names[i]}.png\")\n}\n\nfor(i in 1:length(gtExtra_themes)) {\n  gtsave(gtExtra_styles_list[[i]], str_glue(\"images/gtExtras_theme_{gtExtra_themes_names[i]}.png\"))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngtExtra_themes_names <- c(\"gt_theme_538\", \"gt_theme_espn\", \"gt_theme_nytimes\",\n                          \"gt_theme_guardian\", \"gt_theme_dot_matrix\", \"gt_theme_dark\",\n                          \"gt_theme_excel\", \"gt_theme_pff\")\n\ngtExtras_path_filenames <- vector(mode = \"character\", length = length(gtExtra_themes_names))\n\nfor(i in 1:length(gtExtra_themes_names)) {\n  gtExtras_path_filenames[i] <-  str_glue(\"images/gtExtras_theme_{gtExtra_themes_names[i]}.png\")\n}\n\ngtExtra_style_images_list <- map(gtExtras_path_filenames, magick::image_read) |> \n  map(image_resize, geometry = \"200x200\") \n  \ngtExtra_style_images <- image_join(gtExtra_style_images_list)\n\nimage_append(gtExtra_style_images, stack = FALSE)\n```\n\n::: {.cell-output-display}\n![](themes_files/figure-html/unnamed-chunk-16-1.png){width=800}\n:::\n:::\n\n\n\n## 사용자 테마\n\n기본 표 테마에 글꼴, 텍스트 크기, 색상을 넣어 전문적으로 표를 작성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_theme_gt <- penguins_gt |> \n  gt_theme_538() |> \n  tab_options(\n    # column_labels.background.color = '#1E61B0', # R logo 파란색\n    table.font.names =\"NanumSquare\",    \n    heading.title.font.size = px(26),\n    heading.subtitle.font.size = px(16),    \n    heading.background.color = \"transparent\", \n    column_labels.font.weight = 'bold',\n    table_body.hlines.width = px(0),\n    data_row.padding = px(6),\n    heading.align = 'center',\n    stub.background.color = \"#ffffff\",\n    stub.font.weight = \"bold\",\n    source_notes.font.size = px(10),\n    row.striping.include_table_body = TRUE\n  ) |> \n  cols_align( align = \"center\", columns = where(is.numeric)) |> \n  cols_align( align = \"auto\", columns = where(is.character)) |> \n  ## 글꼴 달리 적용\n  tab_style(\n    style = cell_text(\n      font = \"MaruBuri\",      \n      weight = 'bold' \n    ),\n    locations = cells_title(groups = 'subtitle')\n  ) |> \n  tab_style(\n    style = cell_text(\n      font = \"MaruBuri\",      \n      weight = 'bold' \n    ),\n    locations = cells_body()\n  ) |> \n  tab_style(\n    style = cell_text(\n      font = \"MaruBuri\",      \n      weight = 'bold' \n    ),\n    locations = cells_column_labels()\n  ) |> \n  tab_style(\n    style = cell_text(\n      font = \"MaruBuri\",      \n    ),\n    locations = cells_source_notes()\n  )\n\npenguins_theme_gt |> \n  gtsave(filename = \"images/penguins_theme_gt.png\")\n```\n:::\n\n\n![`gt` 사용자 정의 테마 적용 표](images/penguins_theme_gt.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngt_theme_hangul <- function(gt_tbl) {\n  \n  # Grab number of rows of data from gt object\n  n_rows <- nrow(gt_tbl$`_data`)\n  \n  gt_tbl |> \n    gt_theme_538() |> \n    tab_options(\n      # column_labels.background.color = '#1E61B0', # R logo 파란색\n      table.font.names =\"NanumSquare\",    \n      heading.title.font.size = px(26),\n      heading.subtitle.font.size = px(16),    \n      heading.background.color = \"transparent\", \n      column_labels.font.weight = 'bold',\n      table_body.hlines.width = px(0),\n      data_row.padding = px(6),\n      heading.align = 'center',\n      stub.background.color = \"#ffffff\",\n      stub.font.weight = \"bold\",\n      source_notes.font.size = px(10),\n      row.striping.include_table_body = FALSE\n    ) |> \n    cols_align( align = \"center\", columns = where(is.numeric)) |> \n    cols_align( align = \"auto\", columns = where(is.character)) |> \n    ## 글꼴 달리 적용\n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",      \n        weight = 'bold' \n      ),\n      locations = cells_title(groups = 'subtitle')\n    ) |> \n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",      \n        weight = 'bold' \n      ),\n      locations = cells_body()\n    ) |> \n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",      \n        weight = 'bold' \n      ),\n      locations = cells_column_labels()\n    ) |> \n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",      \n      ),\n      locations = cells_source_notes()\n    ) |> \n    tab_style(\n      style = cell_fill(color = 'grey90'),\n      locations = cells_body(rows = seq(1, n_rows, 2))\n    )    \n}\n\npenguins_gt |> \n  gt_theme_hangul()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"sedcoivoxj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>@import url(\"https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\n#sedcoivoxj table {\n  font-family: NanumSquare;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#sedcoivoxj thead, #sedcoivoxj tbody, #sedcoivoxj tfoot, #sedcoivoxj tr, #sedcoivoxj td, #sedcoivoxj th {\n  border-style: none;\n}\n\n#sedcoivoxj p {\n  margin: 0;\n  padding: 0;\n}\n\n#sedcoivoxj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: 300;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: none;\n  border-top-width: 3px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#sedcoivoxj .gt_title {\n  color: #333333;\n  font-size: 26px;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#sedcoivoxj .gt_subtitle {\n  color: #333333;\n  font-size: 16px;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#sedcoivoxj .gt_heading {\n  background-color: rgba(255, 255, 255, 0);\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_bottom_border {\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_col_headings {\n  border-top-style: none;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bold;\n  text-transform: uppercase;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#sedcoivoxj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bold;\n  text-transform: uppercase;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#sedcoivoxj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#sedcoivoxj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#sedcoivoxj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#sedcoivoxj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#sedcoivoxj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-top-style: none;\n  border-top-width: 2px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 1px;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#sedcoivoxj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  border-top-style: none;\n  border-top-width: 2px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 1px;\n  border-bottom-color: #FFFFFF;\n  vertical-align: middle;\n}\n\n#sedcoivoxj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#sedcoivoxj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#sedcoivoxj .gt_row {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#sedcoivoxj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bold;\n  text-transform: uppercase;\n  border-right-style: solid;\n  border-right-width: 0px;\n  border-right-color: #FFFFFF;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sedcoivoxj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#sedcoivoxj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#sedcoivoxj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#sedcoivoxj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sedcoivoxj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#sedcoivoxj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sedcoivoxj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#sedcoivoxj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sedcoivoxj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sedcoivoxj .gt_sourcenote {\n  font-size: 10px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sedcoivoxj .gt_left {\n  text-align: left;\n}\n\n#sedcoivoxj .gt_center {\n  text-align: center;\n}\n\n#sedcoivoxj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#sedcoivoxj .gt_font_normal {\n  font-weight: normal;\n}\n\n#sedcoivoxj .gt_font_bold {\n  font-weight: bold;\n}\n\n#sedcoivoxj .gt_font_italic {\n  font-style: italic;\n}\n\n#sedcoivoxj .gt_super {\n  font-size: 65%;\n}\n\n#sedcoivoxj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#sedcoivoxj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#sedcoivoxj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#sedcoivoxj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#sedcoivoxj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#sedcoivoxj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#sedcoivoxj .gt_indent_5 {\n  text-indent: 25px;\n}\n\ntbody tr:last-child {\n  border-bottom: 2px solid #ffffff00;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal\" style>남극 펭귄 <strong>서식섬과 종</strong> 빈도표</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style=\"font-family: MaruBuri; font-weight: bold;\"><code>palmerpenguins</code> 데이터 패키지</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: MaruBuri; font-weight: bold;\" scope=\"col\" id=\"Biscoe\">Biscoe</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: MaruBuri; font-weight: bold;\" scope=\"col\" id=\"Dream\">Dream</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: MaruBuri; font-weight: bold;\" scope=\"col\" id=\"Torgersen\">Torgersen</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Adelie</th>\n<td headers=\"stub_1_1 Biscoe\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold; background-color: #E5E5E5;\">44</td>\n<td headers=\"stub_1_1 Dream\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold; background-color: #E5E5E5;\">56</td>\n<td headers=\"stub_1_1 Torgersen\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold; background-color: #E5E5E5;\">52</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Chinstrap</th>\n<td headers=\"stub_1_2 Biscoe\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold;\">0</td>\n<td headers=\"stub_1_2 Dream\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold;\">68</td>\n<td headers=\"stub_1_2 Torgersen\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold;\">0</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Gentoo</th>\n<td headers=\"stub_1_3 Biscoe\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold; background-color: #E5E5E5;\">124</td>\n<td headers=\"stub_1_3 Dream\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold; background-color: #E5E5E5;\">0</td>\n<td headers=\"stub_1_3 Torgersen\" class=\"gt_row gt_center\" style=\"font-family: MaruBuri; font-weight: bold; background-color: #E5E5E5;\">0</td></tr>\n    <tr><th id=\"grand_summary_stub_1\" scope=\"row\" class=\"gt_row gt_left gt_stub gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">합계</th>\n<td headers=\"grand_summary_stub_1 Biscoe\" class=\"gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">168</td>\n<td headers=\"grand_summary_stub_1 Dream\" class=\"gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">124</td>\n<td headers=\"grand_summary_stub_1 Torgersen\" class=\"gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">52</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" style=\"font-family: MaruBuri;\" colspan=\"4\">자료출처: <code>penguins</code> 데이터셋</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## 표 자동 설정\n\n작성한 테마를 매번 코드를 \"복사하여 붙여넣기\" 하여 사용하는 대신 `.Rprofile` 파일에 반영하여\n매번 `gt` 표 제작에 테마를 사용하는 방법을 살펴보자. `usethis` 패키지 `edit_r_profile()` 함수를\n호출하여 앞서 작성한 테마를 반영한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::edit_r_profile()\n```\n:::\n\n\n`gt_theme_hangul()` 테마를 `gt` 표 객체에 반영한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gt)\nlibrary(gtExtras)\n\ngt_theme_hangul <- function(gt_tbl) {\n\n  # Grab number of rows of data from gt object\n  n_rows <- nrow(gt_tbl$`_data`)\n\n  gt_tbl |>\n    gt_theme_538() |>\n    tab_options(\n      # column_labels.background.color = '#1E61B0', # R logo 파란색\n      table.font.names =\"NanumSquare\",\n      heading.title.font.size = px(26),\n      heading.subtitle.font.size = px(16),\n      heading.background.color = \"transparent\",\n      column_labels.font.weight = 'bold',\n      table_body.hlines.width = px(0),\n      data_row.padding = px(6),\n      heading.align = 'center',\n      stub.background.color = \"#ffffff\",\n      stub.font.weight = \"bold\",\n      source_notes.font.size = px(10),\n      row.striping.include_table_body = FALSE\n    ) |>\n    cols_align( align = \"center\", columns = where(is.numeric)) |>\n    cols_align( align = \"auto\", columns = where(is.character)) |>\n    ## 글꼴 달리 적용\n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",\n        weight = 'bold'\n      ),\n      locations = cells_title(groups = 'subtitle')\n    ) |>\n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",\n        weight = 'bold'\n      ),\n      locations = cells_body()\n    ) |>\n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",\n        weight = 'bold'\n      ),\n      locations = cells_column_labels()\n    ) |>\n    tab_style(\n      style = cell_text(\n        font = \"MaruBuri\",\n      ),\n      locations = cells_source_notes()\n    ) |>\n    tab_style(\n      style = cell_fill(color = 'grey90'),\n      locations = cells_body(rows = seq(1, n_rows, 2))\n    )\n}\n```\n:::\n\n\n`.Rprofile` 파일에 `gt` 사용자 정의 테마가 지정되어 있기 때문에 새로 R 세션을 시작하면 \n`gt_theme_hangul()` 테마를 사용할 수 있다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noriginal_penguins_gt <- penguins |> \n  drop_na() |> \n  count(species, sex) |> \n  pivot_wider(names_from = sex, values_from = n, values_fill = 0) |> \n  janitor::adorn_totals(where = \"col\", name = \"합계\") |> \n  rename(펭귄종 = species, 암컷 = female, 수컷 = male) |> \n  as_tibble() |> \n  gt(rowname_col = \"펭귄종\") |> \n    tab_header(\n      title = md(\"남극 펭귄 **암수와 종** 빈도표\"),\n      subtitle = md(\"`palmerpenguins` 데이터 패키지\")\n    ) |> \n    grand_summary_rows(\n      columns = c(펭귄종, 암컷, 수컷),\n      fns = list(\n        '합계' = ~sum(.) \n      ),\n      fmt = ~ fmt_number(., use_seps = FALSE, decimals = 0),\n      missing_text = '-'\n    )  |> \n    cols_align(\"center\") |> \n    opt_row_striping() |> \n    tab_source_note(\n      source_note = md(\"자료출처: `penguins` 데이터셋\")\n  )\n\ntheme_penguins_gt <- original_penguins_gt |> \n  gt_theme_hangul()\n\ngt_theme_hangul_penguins <- gtExtras::gt_two_column_layout(list(original_penguins_gt, theme_penguins_gt))\n\ngt_theme_hangul_penguins |> \n  gtsave_extra(\"images/gt_theme_hangul_penguins.png\", expand = 1)\n```\n:::\n\n\n![`gt_theme_hangul()` 테마 적용 전후](images/gt_theme_hangul_penguins.png)\n",
    "supporting": [
      "themes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}